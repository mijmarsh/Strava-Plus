<head>
	<script src="https://cdn.plot.ly/plotly-2.30.0.min.js" charset="utf-8"></script>
</head>
<body>
	<div id="myDiv"></div>
	<div id="div2"></div>
	<button onClick=getWeeklyData() label="hi">hi</button>
	<script>
		function getWeeklyData() {
			year = 2023
			month = 2
			day = 2
			const week = Date.parse(year+'-'+month+'-'+day)
			const url = 'http://127.0.0.1:5000/me/weekly_data?start_date='+week
			fetch(url)
			.then(response => response.json())  
			.then(json => {
				console.log(json);
				distance_data = json['data']
				console.log(distance_data)
				var data = [
					  {
						x: ['Day 1','Day 2','Day 3','Day 4','Day 5','Day 6','Day 7'],
						y: distance_data,
						type: 'bar',
						text:distance_data.map(String),
						marker: {
							color: 'rgb(255,0,0)',
							opacity: 0.5
						}
					  }
				];
				var layout = {
					title: 'Distance per day',
					xaxis: {
						title: 'Day'
					},
					yaxis: {
						title: 'Distance(km)'
					}
				}

				Plotly.newPlot('myDiv', data,layout);
			})
		}
		function getYearlyData() {
			const url = 'http://127.0.0.1:5000/me/yearly_data'
			fetch(url)
			.then(response => response.json())  
			.then(json => {
				console.log(json);
				distance_data = json['data']
				console.log(distance_data)
				datas = []
				colors = ['rgba(67,67,67,1)', 'rgba(115,115,115,1)', 'rgba(49,130,189, 1)', 'rgba(189,189,189,1)']
				for(let i = 0; i < distance_data.length; i++) {
					var data = {
							// x: ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
							x: Array.from(Array(365).keys()),
							y: distance_data[i],
							type: 'scatter',
							mode: 'lines',
							name: String(2020+i),
							text:distance_data[i].map(String),
							marker: {
								color: 'rgb(255,0,0)',
								opacity: 0.5
							},
							line: {
								color: colors[i]
							}
						  };
					datas.push(data);
					console.log(data)
				}
				console.log(datas)
				var layout = {
					title: 'Distance per year',
					xaxis: {
						title: 'Day'
					},
					yaxis: {
						title: 'Distance(km)'
					}
				}

				Plotly.newPlot('div2', datas,layout);
			})
		}
		getWeeklyData();
		getYearlyData();
	</script>
</body>
